<html lang='en'>

<head>
  <meta charset='UTF-8' />
  <meta name='viewport' content='width=device-width, initial-scale=1.0' />
  <title>Packing Details Report</title>
  <style>
  body {
    font-family: Arial, sans-serif;
    text-align: left;
    margin-right: 60px;
  }

  img.banner {
    width: 100%;
    max-width: 1000px;
    height: auto;
    display: block;
    margin: 0 auto 20px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
    text-align: left;
    font-size: 10px;
  }

  .table-1 {
    margin-top: -20px;
    margin-bottom: 20px;
    font-size: 10px;
  }

  .table-1 th,
  .table-1 td {
    font-size: 10px;
  }

  th,
  td {
    border: 1px solid #000;
    padding: 8px;
    text-align: left;
    font-size: 12px;
    vertical-align: top;
  }

  th {
    background-color: #f2f2f2;
    font-weight: bold;
    font-size: 10px;
  }

  h2,
  h5,
  p {
    text-align: left;
  }

  * {
    position: relative;
    box-sizing: border-box;
  }

  h1, h2, h3, h4, h5, h6, p, table, img, div {
    display: block;
    margin-bottom: 20px !important;
    clear: both;
  }

  body, .outer {
    overflow: visible !important;
  }

  table, img {
    float: none;
  }
  /* ------------------------------------------------------------------ */

  @media print {
    body {
      margin: 10px 20px;
      padding-top: 140px; 
      padding-bottom: 120px;
    }

    .banner-header,
    .banner-footer {
      position: fixed;
      left: 0;
      width: 100%;
      z-index: 9999;
    }

    .banner-header {
      top: 0;
      height: 110px;
    }

    .banner-footer {
      bottom: 0;
      height: 90px;
    }
    .outer {
      position: relative;
      z-index: 1;
      margin-top: -150px;
      margin-bottom: 0;
    }

    html, body {
      height: auto !important;
      overflow: visible !important;
    }
    table {
      page-break-inside: auto;
    }

    tr, img, p, h2, h5 {
      page-break-inside: avoid;
    }

    thead {
      display: table-header-group;
    }

    tfoot {
      display: table-footer-group;
    }

    .screen-only {
      display: none;
    }
    .summary-section {
    page-break-inside: avoid;
    break-inside: avoid;
  }

    /* Keep spacing between elements */
    h1, h2, h3, h4, h5, h6, p, table, img, div {
      margin-bottom: 40px !important;
      clear: both;
    }
    
  }
</style>



</head>

<body>


  <div class='outer'>
    <h5 style='font-size: 12px; font-weight:bold, margin-top: -20px'>
      Packing Details Report Date:
      {{packing_date}}
      &nbsp;&nbsp; Packing Id:
      {{packing_id}}
      &nbsp;&nbsp; Customer Name:
      {{customer_name}}
    </h5>

    <p style='font-size: 12px;margin-top: -30px'><b>
        Product Category:
        {{product_display_type}}
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        Remark:
        {{remark}}
      </b></p>

    <table class='table-1'>
      <thead>
        <tr>
          <th>Item Name</th>
          <th>Photo No.</th>
          <th>Pressing ID</th>
          <th>Length</th>
          <th>Width</th>
          <th>
            {{#if packing_done_item_details.[0].number_of_rolls}}Rolls
            {{else if packing_done_item_details.[0].no_of_leaves}}Leaves
            {{else if packing_done_item_details.[0].quantity}}Quantity
            {{else}}Sheets
            {{/if}}
          </th>

          <th>Sq Mtr</th>
          <th>Bund. No</th>
          <th>Bundles</th>
          <th>No of Bundles</th>
          <th>Remarks</th>
        </tr>
      </thead>
      <tbody>
        {{#each packing_done_item_details}}
        <tr>
          <td>
            {{sales_item_name}}
          </td>

          <td>{{photo_no}}</td>
          <td>{{pressing_id}}</td>
          <td>{{#if new_length}}{{new_length}}{{else}}{{length}}{{/if}}</td>
          <td>{{#if new_width}}{{new_width}}{{else}}{{width}}{{/if}}</td>
          <td>
            {{#if number_of_rolls}}{{number_of_rolls}}
            {{else if no_of_leaves}}{{no_of_leaves}}
            {{else if quantity}}{{quantity}}
            {{else}}{{no_of_sheets}}{{/if}}
          </td>
          <td>{{sqm}}</td>
          <td>{{bundle_no}}</td>
          <td>{{bundle_description}}</td>
          <td>{{total_no_of_bundles}}</td>
          <td>{{remark}}</td>
        </tr>

        {{/each}}

        <tr>
          <td>{{customer_name}}</td>
          <td colspan='4'></td>
          <td>{{totalSheets}}</td>
          <td>{{totalSqMtr}}</td>
          <td colspan='4'></td>
        </tr>
        <tr>
          <td colspan='5'>Grand Total</td>
          <td>{{totalSheets}}</td>
          <td>{{totalSqMtr}}</td>
          <td colspan='4'></td>
        </tr>
      </tbody>
    </table>

    <!-- Item + Size wise Summary -->
<div class="summary-section">
  <h2 style='text-decoration: underline; font-size: 16px;'>Item + Size wise Summary</h2>

  <table>
    <thead>
      <tr>
        <th>Item Name</th>
        <th>Size</th>
        <th>Sheets</th>
        <th>Sq Mtr</th>
      </tr>
    </thead>
    <tbody>
      {{#each item_summary}}
      <tr>
        <td>{{item_name}}</td>
        <td>{{size}}</td>
        <td>{{sheets}}</td>
        <td>{{sqm}}</td>
      </tr>
      {{/each}}
      <tr>
        <td colspan='2'>Total</td>
        <td>{{totalSheets}}</td>
        <td>{{totalSqMtr}}</td>
      </tr>
    </tbody>
  </table>
</div>


  </div>
</body>

</html>